from sklearn.model_selection import KFold
import pandas as pd
from sklearn.metrics import classification_report, confusion_matrix,accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score, cross_val_predict
from sklearn import metrics
import pickle

dig_df = pd.read_csv('C:/Users/athanasis/Desktop/Semester_B/Efarmoges/mathima/fertility_Diagnosis.csv',header=None, sep=',')

print(dig_df.head(3))
print(dig_df.shape)

feautures =  dig_df.iloc[:,:9]
label = dig_df.iloc[:,-1]


X_train, X_test, y_train, y_test = train_test_split(feautures, label, test_size=0.40)

clf = RandomForestClassifier(max_depth=14)
clf.fit(X_train,y_train)

y_pred = clf.predict(X_test)
randf = accuracy_score(y_test, y_pred)
print("RandomForestClassifier simple split",accuracy_score(y_test, y_pred))
print(y_pred)

with open(r'rf.pkl','wb') as model_pkl:
    pickle.dump(clf, model_pkl, protocol=2)